{% extends "plantilla_admin.html" %}

{% block body %}
<div class="container-fluid pt-4 px-4">
    <div class="bg-secondary rounded p-4 mb-4">
        <div class="card-title text-center">
            <h3 class="mb-0 text-white"><b>EDITAR IMAGEN DE VEHÍCULO</b></h3>
        </div>
    </div>

    <div class="bg-secondary rounded p-4">
        <div class="row">
            <div class="col-md-12">
                <form action="{% url 'proceso_actualizar_imagenvehiculo' %}" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <input type="hidden" name="id" value="{{ ImagenVehiculoEditar.id }}">

                    <div class="mb-3">
                        <label for="vehiculo" class="form-label text-white">Vehículo:</label>
                        <select name="vehiculo" id="vehiculo" class="form-select" required>
                            <option value="">Seleccione un vehículo</option>
                            {% for vehiculo in vehiculos %}
                                <option value="{{ vehiculo.id }}" {% if ImagenVehiculoEditar.vehiculo.id == vehiculo.id %}selected{% endif %}>
                                    {{ vehiculo.marca.nombre }} {{ vehiculo.modelo.nombre }} - {{ vehiculo.anio_fabricacion }}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="mb-3">
                        <label for="imagen" class="form-label text-white">Imagen del Vehículo:</label>
                        {% if ImagenVehiculoEditar.imagen %}
                            <div class="mb-2">
                                <img src="{{ ImagenVehiculoEditar.imagen.url }}" alt="Imagen actual" style="max-width: 200px; height: auto;">
                                <p class="text-white-50">Imagen actual</p>
                            </div>
                        {% else %}
                            <p class="text-white-50">No hay imagen actual.</p>
                        {% endif %}
                        <input type="file" name="imagen" class="form-control bg-dark text-white" id="imagen" accept="image/*">
                        <small class="form-text text-muted">Seleccione un nuevo archivo de imagen para reemplazar el actual.</small>
                    </div>

                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" name="es_principal" id="es_principal" {% if ImagenVehiculoEditar.es_principal %}checked{% endif %}>
                        <label class="form-check-label text-white" for="es_principal">
                            Es Imagen Principal
                        </label>
                    </div>

                    <div class="mb-3">
                        <label for="orden" class="form-label text-white">Orden de visualización:</label>
                        <input type="number" name="orden" class="form-control" value="{{ ImagenVehiculoEditar.orden|default:0 }}" id="orden" min="0">
                        <small class="form-text text-muted">Define el orden en que se mostrará la imagen (0 para la primera).</small>
                    </div>

                    <br>
                    <button type="submit" class="btn btn-warning me-2">Actualizar</button>
                    <a href="{% url 'listado_imagenes_vehiculo' %}" class="btn btn-outline-primary">Cancelar</a>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}